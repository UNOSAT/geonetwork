<div id="main-container" data-theme="main" ng-controller="MainController as mainCtrl">

  <!--Header-->
  <header class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="http://reseau-tchad.org/" target="_blank">
          <img class="respimg" width="180" alt="ResEau" src="../../catalog/views/unosat/img/Logo_cercle_ResEau_v1_lueur.png" style="">
        </a>
      </div>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <un-search un-search-map="mainCtrl.map"></un-search>
        </li>
      </ul>

    </div>

  </header>

  <!--Container-->
  <div id="map-container" >
    <div id="sidebar" ng-class="{open: mainCtrl.sidebarOpen()}"
         ngeo-resizemap="mainCtrl.map">

      <!--Layers sidebar-->
      <div id="layers" data-ng-show="mainCtrl.layersOpen">
        <h2 translate>geoportal</h2>
        <button class="close-panel" ng-click="mainCtrl.closeSidebar()">
          ✕
        </button>

        <!--Tab panel header-->
        <ul class="nav nav-tabs">
          <li role="presentation" class="active">
            <a href="#mymap" data-toggle="tab">
              <span translate>mylayers</span>
              <span ng-if="mainCtrl.selectedLayers.length > 0">({{mainCtrl.selectedLayers.length}})</span>
            </a>
          </li>
          <li role="presentation">
            <a href="#catalog" data-toggle="tab" translate>catalog</a>
          </li>
        </ul>

        <!--Tab panel content-->
        <div class="tab-content">

          <!--Mymap, list of inmap layer-->
          <div id="mymap" class="tab-pane active">
            <un-layermanager un-layermanager-map="::mainCtrl.map"
                             un-layermanager-layers="::mainCtrl.selectedLayers">
            </un-layermanager>
            <div class="text-center">
              <button class="btn btn-default" ng-click="mainCtrl.showTab('a[href=#catalog]');" translate>+ Ajouter</button>
            </div>
            <button data-ng-if="mainCtrl.selectedLayers.length > 0" class="btn btn-default" id="legendBtn" ng-click="mainCtrl.legendOpen = !mainCtrl.legendOpen">Légende</button>
          </div>

          <!--Catalog tree-->
          <div id="catalog" class="tab-pane">
            <un-catalog un-catalog-map="::mainCtrl.map"></un-catalog>
          </div>
        </div>
      </div>

      <!--Import sidebar-->
      <div id="import" data-ng-show="mainCtrl.importOpen">
        <h2 translate>Import externe</h2>
        <button class="close-panel" ng-click="mainCtrl.closeSidebar()">
          ✕
        </button>

        <!--Tab panel header-->
        <ul class="nav nav-tabs">
          <li role="presentation" class="active">
            <a href="#importkml" data-toggle="tab" translate>KML</a>
          </li>
          <li role="presentation">
            <a href="#importwms" data-toggle="tab">WMS</a>
          </li>
          <li role="presentation">
            <a href="#importwmts" data-toggle="tab" translate>WMTS</a>
          </li>
        </ul>

        <!--Tab panel content-->
        <div class="tab-content">

          <!--Import KML-->
          <div id="importkml" class="tab-pane">
            <div gn-kml-import="" gn-kml-import-map="::mainCtrl.map"></div>
          </div>

          <!--Import WMS-->
          <div id="importwms" class="tab-pane active">
            <div gn-wms-import="wms"
                 gn-wms-import-map="::mainCtrl.map"
                 services-list-from-catalog="true"></div>
          </div>

          <!--Import WMTS-->
          <div id="importwmts" class="tab-pane">
            <div gn-wms-import="wmts" gn-wms-import-map="::mainCtrl.map"></div>
          </div>
        </div>
      </div>

      <!--Map management (save/load contexts)-->
      <div id="contextpanel" data-ng-show="mainCtrl.contextOpen">
        <h2 translate>maps</h2>
        <button class="close-panel" ng-click="mainCtrl.closeSidebar()">
          ✕
        </button>

        <div gn-ows-context="" map="::mainCtrl.map"></div>
      </div>

      <!--Print form panel-->
      <div id="printpanel" data-ng-show="mainCtrl.printOpen">
        <h2 translate>print</h2>
        <button class="close-panel" ng-click="mainCtrl.closeSidebar()">
          ✕
        </button>
        <div gn-mapprint="" print-active="mainCtrl.printOpen" map="::mainCtrl.map"></div>
      </div>

      <!--Drawing-->
      <div id="drawpanel" data-ng-show="mainCtrl.drawOpen">
        <h2 translate>draw</h2>
        <button class="close-panel" ng-click="mainCtrl.closeSidebar()">
          ✕
        </button>

        <div class="gn-draw-text" gn-draw="" map="::mainCtrl.map" vector="::mainCtrl.drawVector"></div>
      </div>

    </div>

    <div id="infopanel"
         ng-class="{open: mainCtrl.infopanelOpen(), offset: mainCtrl.sidebarOpen()}">
      <div id="showlayerinfo" data-ng-show="mainCtrl.unLayerState.md">
        <h4>{{mainCtrl.unLayerState.md.title || mainCtrl.unLayerState.md.defaultTitle}}</h4>
        <button class="close-panel" ng-click="mainCtrl.closeInfopanel()">
          ✕
        </button>
        <div un-layerinfo=""></div>
      </div>
      <div class="legend-container" data-ng-show="mainCtrl.legendOpen">
        <h4>Légende</h4>
        <button class="close-panel" ng-click="mainCtrl.closeInfopanel()">
          ✕
        </button>
        <div gn-legend-panel="::mainCtrl.map" />
      </div>
    </div>

    <div class="un-main-tools" ngeo-btn-group ng-class="{active: mainCtrl.sidebarOpen()}">
      <button class="un-tool-btn btn" ngeo-btn ng-model="mainCtrl.layersOpen"><span class="icon layers"></span> </button>
      <button class="un-tool-btn btn" ngeo-btn ng-model="mainCtrl.importOpen"><span class="fa fa-plus"></span> </button>
      <button class="un-tool-btn btn" ngeo-btn ng-model="mainCtrl.contextOpen"><i class="icon map"></i> </button>
      <button class="un-tool-btn btn" ngeo-btn ng-model="mainCtrl.printOpen"><i class="fa fa-print"></i> </button>
      <button class="un-tool-btn btn" ngeo-btn ng-model="mainCtrl.mInteraction.active"><i class="icon measure"></i> </button>
      <button class="un-tool-btn btn" ngeo-btn ng-model="mainCtrl.drawOpen"><i class="fa fa-pencil"></i> </button>
    </div>

    <div id="measurepanel" data-ng-show="mainCtrl.mInteraction.active">
      <button class="close-panel" ng-click="mainCtrl.mInteraction.active = false">
        ✕
      </button>
      <div class="gn-measure-text">
        <dl class="dl-horizontal">
          <dt>{{'Distance' | translate}}</dt>
          <dd>{{mainCtrl.measureObj.distance | measure}}</dd>
          <dt>{{'Surface' | translate}}</dt>
          <dd>{{mainCtrl.measureObj.surface | measure:'area':['km&sup2', ' m&sup2']}}</dd>
        </dl>
      </div>
    </div>

    <div ngeo-map="mainCtrl.map">
    </div>

    <div gn-gfi=""  map="mainCtrl.map" ></div>

    <!--Background selector-->
    <un-bg-selector un-bg-selector-map="::mainCtrl.map" class="ga-bg-desktop"></un-bg-selector>
  </div>
  <footer ng-class="{'offset-left': mainCtrl.sidebarOpen()}">
    <un-mouseposition class="" map="mainCtrl.map">
    </un-mouseposition>
<!--
    <div id="scale-position" ngeo-control="mainCtrl.scaleControl" ngeo-control-map="mainCtrl.map"></div>
-->
  </footer>
</div>